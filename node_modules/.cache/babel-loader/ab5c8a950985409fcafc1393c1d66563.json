{"ast":null,"code":"'use strict';\n\nvar streams = require('streamroller');\n\nvar os = require('os');\n\nvar eol = os.EOL || '\\n';\n/**\n * File appender that rolls files according to a date pattern.\n * @filename base filename.\n * @pattern the format that will be added to the end of filename when rolling,\n *          also used to check when to roll files - defaults to '.yyyy-MM-dd'\n * @layout layout function for log messages - defaults to basicLayout\n * @timezoneOffset optional timezone offset in minutes - defaults to system local\n */\n\nfunction appender(filename, pattern, layout, options, timezoneOffset) {\n  var logFile = new streams.DateRollingFileStream(filename, pattern, options);\n\n  var app = function app(logEvent) {\n    logFile.write(layout(logEvent, timezoneOffset) + eol, 'utf8');\n  };\n\n  app.shutdown = function (complete) {\n    logFile.write('', 'utf-8', function () {\n      logFile.end(complete);\n    });\n  };\n\n  return app;\n}\n\nfunction configure(config, layouts) {\n  var layout = layouts.basicLayout;\n\n  if (config.layout) {\n    layout = layouts.layout(config.layout.type, config.layout);\n  }\n\n  if (!config.alwaysIncludePattern) {\n    config.alwaysIncludePattern = false;\n  }\n\n  return appender(config.filename, config.pattern, layout, config, config.timezoneOffset);\n}\n\nmodule.exports.configure = configure;","map":null,"metadata":{},"sourceType":"script"}